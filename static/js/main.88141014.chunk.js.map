{"version":3,"sources":["components/ControlBar.js","components/Imagepopup.js","components/MapPane.js","components/listItems.js","components/SimpleDialog.js","components/FullScreenDialog.js","components/RegistDialog.js","components/Dashboard.js","App.js","reportWebVitals.js","index.js"],"names":["setSlider","endRunning","setRunning","speedChange","imagePop","imageClose","spId","ControlBar","props","state","play_state","val","label","value","setState","Math","ceil","stopMovie","startMovie","setSpeed","style","bar_style","ListItem","Button","variant","color","marginRight","onClick","this","Slider","getAriaValueText","onChangeProgress","aria-labelledby","valueLabelDisplay","step","marks","min","max","onChange","onChangeVal","marginLeft","Component","ieRunning","setPhase","target","float","width","lineHeight","borderRadius","border","padding","background","position","bottom","left","zindex","useStyles","makeStyles","theme","modal","display","alignItems","justifyContent","backgroundcolor","img","outline","Imagepopup","classes","useState","open","setOpen","image","setImage","url","console","log","Modal","className","onClose","closeAfterTransition","BackdropComponent","Backdrop","BackdropProps","backgroundColor","Fade","in","timeout","src","alt","maxHeight","maxWidth","targetRoute","map","mapbox","workerClass","MapboxWorker","routeDistance","speed","start","phase","pointer","runAni","cameraAltitude","running","angle","camera_angle","speedMul","angleVal","dem","vector","parseGeojson","str","json","JSON","parse","features","forEach","e","c","geometry","coordinates","type","push","propcLine","getLayer","removeLayer","getSource","removeSource","setGeojsonLayer","fitBounds","frame","requestAnimationFrame","cancelAnimationFrame","xmin","xmax","ymin","ymax","element","addPhoto","viewState","window","innerWidth","height","innerHeight","longitude","latitude","zoom","maxZoom","pitch","MapPane","Map","accessToken","container","hash","PHT","center","minZoom","bearing","interactive","localIdeographFontFamily","deckgl","Deck","gl","painter","context","layers","initialViewState","addControl","FullscreenControl","NavigationControl","on","setTerrain","setSky","setVector","loadImage","error","addImage","arg","getArg","location","search","page","i","itemData","length","no","getItem","axios","get","then","res","data","stringify","startPage","point","move","preventDefault","originalEvent","deltaY","ref","STD","x0","x","y0","y","x1","y1","e2","flg","touches","PI","cos","sin","updateGeojsonLayer","mapobj","addSource","addLayer","source","id","paint","layout","turf","Object","pair","substring","split","kv","ll","LngLat","prop","properties","divElement","document","createElement","pElement","innerHTML","imgElement","setAttribute","addEventListener","appendChild","Popup","setLngLat","setDOMContent","addTo","time","dd","Date","now","setTimeout","alongRoute","camera","getFreeCameraOptions","MercatorCoordinate","fromLngLat","lng","lat","lookAtPoint","setFreeCameraOptions","setData","fileRead","params","URLSearchParams","set","toString","MainListItems","d3","ImageList","cols","ImageListItem","ListSubheader","component","item","srcSet","process","loading","ImageListItemBar","title","subtitle","date","actionIcon","IconButton","sx","aria-label","SimpleDialog","selectedValue","Dialog","DialogTitle","frameBorder","allow","allowFullScreen","YoutubeDialog","React","size","Copyright","Typography","align","Link","href","getFullYear","handleDialogOpen","handleDialogClose","appBar","spacing","flex","img_style","Transition","forwardRef","Slide","direction","FullScreenDialog","isLoadwidgets","setup","fullScreen","TransitionComponent","AppBar","Toolbar","edge","Box","xs","md","textAlign","fontSize","margin","fname","Follow","useEffect","s","body","data-show-count","gpxParser","require","dialog","toolbar","box","textField","fontfamily","button","RegistDialog","startDate","setStartDate","photo_src","setPhotoSrc","route_src","setJson","handleClose","fileProc","obj","endsWith","gpx","toGeoJSON","post","headers","accept","withCredentials","AccessControlAllowOrigin","AccessControlAllowMethods","preflightContinue","catch","TextField","placeholder","autoComplete","fileInput","getElementById","fileReader","FileReader","onchange","file","files","name","toLowerCase","readAsText","onload","result","click","startIcon","selected","readAsDataURL","colSpan","tcxParse","DOMParser","drawerWidth","root","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","easeOut","enteringScreen","menuButton","hide","drawer","flexShrink","drawerPaper","boxSizing","drawerHeader","mixins","content","flexGrow","contentShift","toolbarButtons","doc","parseFromString","tcx","current_map","MAPS","changeMap","terrain","setStyle","Dashboard","useTheme","handleDrawerOpen","handleDrawerClose","CssBaseline","clsx","noWrap","Grid","Divider","orientation","flexItem","Tooltip","placement","Drawer","anchor","paper","List","Container","Child","useLocation","App","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.88141014.chunk.js","sourcesContent":["import React, { Component} from 'react';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Button from '@material-ui/core/Button';\r\nimport {startMovie,stopMovie,setPhase,ieRunning,setSpeed} from './MapPane'\r\n\r\nexport let setSlider;\r\nexport let endRunning;\r\nlet setRunning;\r\n\r\nlet spId=0;\r\nlet speedChange;\r\n\r\nexport default class ControlBar extends Component {\r\n    \r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n          play_state: \"開始\",\r\n          val:0,\r\n          label:\"低速\"\r\n        }\r\n    };\r\n\r\n    componentDidMount(){\r\n        setSlider=(value)=>{\r\n            this.setState({val:Math.ceil(value*100)});\r\n        };\r\n        endRunning=()=>{\r\n            stopMovie();\r\n            this.setState({play_state: \"開始\"});\r\n        };\r\n        setRunning=()=>{\r\n            if(this.state.play_state===\"開始\"){\r\n                startMovie();\r\n                this.setState({play_state: \"停止\"});\r\n            }else{\r\n                stopMovie();\r\n                this.setState({play_state: \"開始\"});\r\n            }\r\n        };\r\n        speedChange=()=>{\r\n            spId=(spId+1)%3;\r\n            if(spId===0){\r\n                setSpeed(1.0);\r\n                this.setState({label:\"低速\"});\r\n            }else if(spId===1){\r\n                setSpeed(2.0);\r\n                this.setState({label:\"中速\"});\r\n            }else{\r\n                setSpeed(3.0);\r\n                this.setState({label:\"高速\"});\r\n            }\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return <div style={bar_style}>\r\n        <ListItem>\r\n        <Button variant=\"contained\" color=\"primary\" style={{marginRight:\"20px\"}} onClick={setRunning}>{this.state.play_state}</Button>\r\n        <Slider\r\n          value={this.state.val}\r\n          getAriaValueText={onChangeProgress}\r\n          aria-labelledby=\"discrete-slider\"\r\n          valueLabelDisplay=\"auto\"\r\n          step={1}\r\n          marks\r\n          min={0}\r\n          max={100}\r\n          onChange={onChangeVal}\r\n        />\r\n        <Button variant=\"contained\" color=\"primary\" style={{marginLeft:\"20px\"}} onClick={speedChange}>{this.state.label}</Button>\r\n        </ListItem>\r\n        </div>;\r\n    };\r\n}\r\n\r\nconst onChangeProgress=(value)=>{\r\n\r\n};\r\n\r\nconst onChangeVal=(val)=>{\r\n    if(!ieRunning())setPhase(val.target.value/100.0);\r\n};\r\n\r\nconst bar_style = {\r\n    float: \"left\",\r\n    width: \"96%\", \r\n    lineHeight: \"32px\",\r\n    borderRadius: 4,\r\n    border: \"none\",\r\n    padding: \"0px 20px 0px 20px\",\r\n    color: \"#fff\",\r\n    background: \"#ffffff88\",\r\n    position: \"absolute\",\r\n    bottom: 35,\r\n    left: \"2%\",\r\n    zindex:255\r\n};  ","import {\r\n    makeStyles,\r\n    Modal,\r\n    Backdrop,\r\n    Fade\r\n  } from \"@material-ui/core\";\r\nimport { CancelPresentationOutlined } from \"@material-ui/icons\";\r\n  import React, { useState } from \"react\";\r\n  \r\n  const useStyles = makeStyles((theme) => ({\r\n    modal: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      justifyContent: \"center\",\r\n      \"&:hover\": {\r\n        backgroundcolor: \"red\"\r\n      }\r\n    },\r\n    img: {\r\n      outline: \"none\"\r\n    }\r\n  }));\r\n\r\n  export let imagePop;\r\n  export let imageClose;\r\n  \r\n  export default function Imagepopup() {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = useState(false);\r\n    const [image, setImage] = useState(\"false\");\r\n  \r\n    imagePop = (url) => {\r\n        console.log(url);\r\n        setImage(url);\r\n        setOpen(true);\r\n    };\r\n    \r\n    imageClose = () => {\r\n        setOpen(false);\r\n    };\r\n  \r\n    return (\r\n      <div>\r\n        <Modal\r\n          className={classes.modal}\r\n          open={open}\r\n          onClose={imageClose}\r\n          closeAfterTransition\r\n          BackdropComponent={Backdrop}\r\n          BackdropProps={{\r\n            style: {\r\n                backgroundColor: \"transparent\",\r\n              }\r\n          }}\r\n        >\r\n          <Fade in={open} timeout={500} className={classes.img}>\r\n            <img\r\n              src={image}\r\n              alt=\"asd\"\r\n              style={{ maxHeight: \"90%\", maxWidth: \"90%\" }}\r\n            />\r\n          </Fade>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }","import React, { Component } from 'react';\r\n//import mapbox from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport './MapPane.css';\r\nimport {Deck} from '@deck.gl/core';\r\nimport * as turf from '@turf/turf'\r\nimport {setSlider,endRunning} from './ControlBar';\r\nimport {startPage} from './listItems';\r\nimport {imagePop,imageClose} from './Imagepopup'\r\nimport axios from 'axios';\r\nimport mapbox from 'mapbox-gl/dist/mapbox-gl-csp';\r\n// eslint-disable-next-line import/no-webpack-loader-syntax\r\nimport MapboxWorker from 'worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker';\r\nmapbox.workerClass = MapboxWorker;\r\n\r\nlet targetRoute;\r\nlet map;\r\nlet cameraAltitude = 500;\r\nlet routeDistance;\r\nlet speed;\r\nlet start;\r\nlet running=false;\r\nlet phase;\r\nlet angle=0.0;\r\nlet camera_angle=[-0.005,-0.005];\r\nlet speedMul=1.0;\r\nlet pointer;\r\nlet angleVal=0;\r\nlet runAni;\r\n\r\nconst photo_URL=\"https://www.termat.net/photo/get/bounds/\"\r\nconst image_URL=\"https://www.termat.net/photo/get/image/\"\r\n\r\nconst dem={\r\n    \"type\": \"raster-dem\",\r\n    \"tiles\": [\r\n      \"https://www.termat.net/dem/{z}/{x}/{y}\"\r\n    ],\r\n    \"tileSize\": 256,\r\n    \"maxzoom\": 14,\r\n    \"attribution\": \"<a href='https://maps.gsi.go.jp/development/ichiran.html'>地理院タイル</a>\"\r\n  };\r\n\r\n const mvt={\r\n    \"type\": \"vector\",\r\n    \"glyphs\": \"https://maps.gsi.go.jp/xyz/noto-jp/{fontstack}/{range}.pbf\",\r\n    \"tiles\": [\"/potaling/mvt/{z}/{x}/{y}.pbf\"],\r\n    \"minzoom\":12,\r\n    \"maxzoom\": 17,\r\n    \"attribution\": \"<a href='https://github.com/gsi-cyberjapan/gsimaps-vector-experiment'>地理院ベクトルタイル</a>\"\r\n  };\r\n\r\n  const vector={\r\n    \"type\": \"vector\",\r\n    \"glyphs\": \"https://maps.gsi.go.jp/xyz/noto-jp/{fontstack}/{range}.pbf\",\r\n    \"tiles\": [\r\n        \"https://cyberjapandata.gsi.go.jp/xyz/experimental_bvmap/{z}/{x}/{y}.pbf\"\r\n    ],\r\n    \"minzoom\":9,\r\n    \"maxzoom\": 16\r\n  };\r\n\r\nexport const setSpeed=(val)=>{\r\n    speedMul=val;\r\n}\r\n\r\nexport const ieRunning=()=>{\r\n    return running;\r\n};\r\n\r\nexport const jumpTo=(data)=>{\r\n    map.jumpTo({center: data});\r\n};\r\n\r\nconst propcLine=(c)=>{\r\n    c.forEach(e =>{\r\n        targetRoute.push(e);\r\n    });\r\n}\r\n\r\nexport const parseGeojson=(str)=>{\r\n    stopMovie();\r\n    let json=JSON.parse(str);\r\n    targetRoute=[];\r\n\r\n    let array=json.features;\r\n    array.forEach(e => {\r\n        let c=e.geometry.coordinates;\r\n        if(e.geometry.type===\"Point\"){\r\n            targetRoute.push(c);\r\n        }else if(e.geometry.type===\"LineString\"){\r\n            propcLine(c);\r\n        }\r\n    });\r\n    if (map.getLayer('line'))map.removeLayer('line');\r\n    if (map.getSource('trace'))map.removeSource('trace');\r\n    if (map.getLayer('point'))map.removeLayer('point');\r\n    if (map.getSource('point'))map.removeSource('point');\r\n    setGeojsonLayer(map);\r\n    fitBounds();\r\n    start=null;\r\n    phase=0.0;\r\n    setSlider(0);\r\n};\r\n\r\nexport const setPhase=(val)=>{\r\n    phase=val;\r\n    if(phase===0.0)start=null;\r\n    if(targetRoute)frame();\r\n}\r\n\r\nexport const startMovie=()=>{\r\n    running=true;\r\n    if(targetRoute)requestAnimationFrame(frame);\r\n};\r\n\r\nexport const stopMovie=()=>{\r\n    running=false;\r\n    cancelAnimationFrame(runAni);\r\n    start=null;\r\n};\r\n\r\nexport const fitBounds=()=>{\r\n    if(!targetRoute)return;\r\n    let xmin=100000;\r\n    let xmax=-10000;\r\n    let ymin=100000;\r\n    let ymax=-10000;\r\n    targetRoute.forEach(element => {\r\n        xmin=Math.min(xmin,element[0]);\r\n        xmax=Math.max(xmax,element[0]);\r\n        ymin=Math.min(ymin,element[1]);\r\n        ymax=Math.max(ymax,element[1]);\r\n    });\r\n    map.fitBounds([\r\n        [xmin, ymin],\r\n        [xmax, ymax]\r\n    ]);\r\n    addPhoto(map,xmin,xmax,ymin,ymax);\r\n};\r\n\r\nexport const changeStyle=(style,flg)=>{\r\n    if(style.terrain){\r\n        delete style.terrain\r\n    }    \r\n    map.setStyle(style);\r\n    map.on('style.load', () => {\r\n        setTerrain(map);\r\n        setSky(map);\r\n        if(targetRoute)updateGeojsonLayer(map);\r\n        if(flg===0)setVector(map);\r\n    });\r\n};\r\n\r\nconst viewState = {\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n    longitude: 139.692704,\r\n    latitude: 35.689526,\r\n    zoom: 14,\r\n    maxZoom: 18,\r\n    pitch: 65\r\n };\r\n\r\nexport default class MapPane extends Component {\r\n//    static SAT='mapbox://styles/mapbox/satellite-v9';\r\n    static STD='/potaling/std.json';\r\n    static PHT= {\r\n            \"version\": 8,\r\n            \"glyphs\": \"https://maps.gsi.go.jp/xyz/noto-jp/{fontstack}/{range}.pbf\",\r\n            \"sources\": {\r\n                \"t_pale\": {\r\n                    \"type\": \"raster\",\r\n                    \"tiles\": [\r\n                        \"https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg\"\r\n                    ],\r\n                    \"tileSize\": 256,\r\n                    \"attribution\": \"<a href='https://maps.gsi.go.jp/development/ichiran.html'>地理院タイル（全国最新写真）</a>\"\r\n                }\r\n            },\r\n            \"layers\": [{\r\n                \"id\": \"t_pale\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"t_pale\",\r\n                \"minzoom\": 8,\r\n                \"maxzoom\": 18\r\n            }]\r\n        };\r\n\r\n    componentDidMount() {\r\n        map = new mapbox.Map({\r\n            accessToken:'pk.eyJ1IjoidGVybWF0IiwiYSI6ImNrcGprNXE2ajBjdmQybnFyMmI5d3lrN2UifQ.EyZTUEX49xUnq6i2y0Na2Q',\r\n            container: this.container,\r\n            hash: true,\r\n            style: MapPane.PHT,\r\n            center: [139.692704, 35.689526], \r\n            zoom: 14,\r\n            maxZoom: 18,\r\n            minZoom: 8,\r\n            pitch: 65,\r\n            bearing: 0,\r\n            interactive: true,\r\n            localIdeographFontFamily: false,\r\n//            antialias: true \r\n        });\r\n\r\n        this.deckgl = new Deck({\r\n            gl: map.painter.context.gl,\r\n            layers: [],\r\n            initialViewState:viewState\r\n        });\r\n\r\n        map.addControl(new mapbox.FullscreenControl());\r\n        map.addControl(new mapbox.NavigationControl());\r\n\r\n        map.on('load', () => {\r\n            setTerrain(map);\r\n            setSky(map);\r\n//            setMvt(map);\r\n            setGeojsonLayer(map);\r\n            setVector(map);\r\n            map.loadImage(\r\n                '/potaling/camera.png',(error, image) => {\r\n                    if (error) throw error;\r\n                    map.addImage('custom-marker', image);\r\n                }\r\n            );\r\n            const arg=getArg(window.location.search);\r\n            if(arg[\"p\"]){\r\n                startPage(arg[\"p\"]);\r\n            }\r\n        });\r\n\r\n        map.on('touchstart', (e)=> {\r\n            pointer=e.point;\r\n        });\r\n        map.on('touchend', (e)=> {\r\n            pointer=null;\r\n        });\r\n\r\n        map.on('mousedown', (e)=> {\r\n            pointer=e.point;\r\n        });\r\n        map.on('mouseup', (e)=> {\r\n            pointer=null;\r\n        });\r\n        map.on('mouseout', (e)=> {\r\n            pointer=null;\r\n        });\r\n        map.on('mousemove', (e)=> {\r\n            move(e);\r\n        });\r\n        map.on('touchmove', (e)=> {\r\n            move(e);\r\n        });\r\n        map.on('wheel',(e)=>{\r\n            if(running){\r\n                e.preventDefault();\r\n                console.log(e.originalEvent.deltaY>0);\r\n                if(e.originalEvent.deltaY>0){\r\n                    cameraAltitude=Math.min(2000,cameraAltitude+50);\r\n                }else{\r\n                    cameraAltitude=Math.max(200,cameraAltitude-50);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return <div className={'map'} ref={(e) => (this.container = e)} />;\r\n    }\r\n}\r\n\r\nconst move=(e)=>{\r\n    if(running&&pointer){\r\n        e.preventDefault();\r\n        let x0=pointer.x;\r\n        let y0=pointer.y;\r\n        let x1=e.point.x;\r\n        let y1=e.point.y;\r\n        const e2 = e.originalEvent;\r\n        let flg=false;\r\n        if (e2 && 'touches' in e2) {\r\n            if (e2.touches.length > 1) {\r\n                flg=true;\r\n            }\r\n        }\r\n        if (flg) {\r\n            if(y1>y0){\r\n                cameraAltitude=Math.min(2000,cameraAltitude+50);\r\n            }else{\r\n                cameraAltitude=Math.max(200,cameraAltitude-50);\r\n            }\r\n        }else{\r\n            if(x1>x0){\r\n                angleVal=(angleVal+5)%360;\r\n                angle=(angleVal/180.0)*Math.PI;\r\n                camera_angle=[\r\n                    -0.005*Math.cos(angle)-(-0.005)*Math.sin(angle),\r\n                    -0.005*Math.sin(angle)+(-0.005)*Math.cos(angle)\r\n                ];\r\n            }else{\r\n                angleVal=(angleVal-5)%360;\r\n                angle=(angleVal/180.0)*Math.PI;\r\n                camera_angle=[\r\n                    -0.005*Math.cos(angle)-(-0.005)*Math.sin(angle),\r\n                    -0.005*Math.sin(angle)+(-0.005)*Math.cos(angle)\r\n                ];\r\n            }\r\n        }\r\n        if(pointer)pointer=e.point;\r\n    }\r\n};\r\n\r\nconst updateGeojsonLayer=(mapobj)=>{\r\n    if (!mapobj.getSource('trace')){\r\n        mapobj.addSource('trace', {\r\n            type: 'geojson',\r\n            data: {\r\n            'type': 'Feature',\r\n            'properties': {},\r\n            'geometry': {\r\n                'type': 'LineString',\r\n                'coordinates': targetRoute\r\n                }\r\n            }\r\n        });\r\n    }\r\n    if (!mapobj.getLayer('line')){\r\n        mapobj.addLayer({\r\n            type: 'line',\r\n            source: 'trace',\r\n            id: 'line',\r\n            paint: {\r\n                'line-color': 'orange',\r\n                'line-width': 5\r\n            },\r\n            layout: {\r\n                'line-cap': 'round',\r\n                'line-join': 'round'\r\n            }\r\n        });\r\n    }\r\n    if (!mapobj.getSource('point')){\r\n        let point = {\r\n            'type': 'FeatureCollection',\r\n            'features': [{\r\n                'type': 'Feature',\r\n                'properties': {},\r\n                'geometry': {\r\n                    'type': 'Point',\r\n                    'coordinates': targetRoute[0]\r\n                }\r\n            }]\r\n        };\r\n        mapobj.addSource('point', {\r\n            'type': 'geojson',\r\n            'data': point \r\n        });\r\n    }\r\n    if (!mapobj.getLayer('point')){\r\n        mapobj.addLayer({\r\n            'id': 'point',\r\n            'source': 'point',\r\n            'type': 'circle',\r\n            'paint': {\r\n                'circle-color': \"#ff0000\",\r\n                'circle-radius':8,\r\n                'circle-stroke-width': 4,\r\n                'circle-stroke-opacity': 0.05\r\n            },\r\n        });\r\n    }\r\n};\r\n\r\nconst setGeojsonLayer=(mapobj)=>{\r\n    if(targetRoute){\r\n        mapobj.addSource('trace', {\r\n            type: 'geojson',\r\n            data: {\r\n            'type': 'Feature',\r\n            'properties': {},\r\n            'geometry': {\r\n                'type': 'LineString',\r\n                'coordinates': targetRoute\r\n                }\r\n            }\r\n        });\r\n        mapobj.addLayer({\r\n            type: 'line',\r\n            source: 'trace',\r\n            id: 'line',\r\n            paint: {\r\n                'line-color': 'orange',\r\n                'line-width': 5\r\n            },\r\n            layout: {\r\n                'line-cap': 'round',\r\n                'line-join': 'round'\r\n            }\r\n        });\r\n        let point = {\r\n            'type': 'FeatureCollection',\r\n            'features': [{\r\n                'type': 'Feature',\r\n                'properties': {},\r\n                'geometry': {\r\n                    'type': 'Point',\r\n                    'coordinates': targetRoute[0]\r\n                }\r\n            }]\r\n        };\r\n        mapobj.addSource('point', {\r\n            'type': 'geojson',\r\n            'data': point \r\n        });\r\n        mapobj.addLayer({\r\n            'id': 'point',\r\n            'source': 'point',\r\n            'type': 'circle',\r\n            'paint': {\r\n                'circle-color': \"#ff0000\",\r\n                'circle-radius':8,\r\n                'circle-stroke-width': 4,\r\n                'circle-stroke-opacity': 0.05\r\n            },\r\n        });\r\n        routeDistance = turf.length(turf.lineString(targetRoute));\r\n        speed=1/((routeDistance/10)*60000);\r\n    }\r\n};\r\n\r\nconst setTerrain=(mapobj)=>{\r\n    if (!mapobj.getSource('mapbox-dem')){\r\n        mapobj.addSource('mapbox-dem', dem);\r\n        mapobj.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.25 });\r\n    }\r\n};\r\n\r\nconst setMvt=(mapobj)=>{\r\n    if (!mapobj.getSource('mvt')){\r\n        mapobj.addSource('mvt', mvt);\r\n\t\tmapobj.addLayer({\r\n\t\t\t\"id\": \"bldg\",\r\n\t\t\t\"type\": \"fill-extrusion\",\r\n\t\t\t\"source\": \"mvt\",\r\n\t\t\t\"source-layer\": \"BUILDING\",\r\n\t\t\t\"minzoom\": 12,\r\n\t\t\t\"maxzoom\": 17,\r\n\t\t\t\"paint\": {\r\n\t\t\t\t\"fill-extrusion-color\": [\r\n\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t['linear'],\r\n\t\t\t\t\t[\"get\", \"height\"],\r\n\t\t\t\t\t\t0,'blue',\r\n\t\t\t\t\t\t10,'royalblue',\r\n\t\t\t\t\t\t20,'cyan',\r\n\t\t\t\t\t\t30,'lime',\r\n\t\t\t\t\t\t40,'yellow',\r\n\t\t\t\t\t\t50,'orange',\r\n\t\t\t\t\t\t60,'red'],\r\n\t\t\t\t\"fill-extrusion-height\": [\"get\", \"height\"],\r\n\t\t\t\t'fill-extrusion-opacity': 0.75,\r\n\t\t\t}\r\n\t\t});\r\n    }\r\n};\r\n\r\nconst setVector=(mapobj)=>{\r\n    if (!mapobj.getSource('vector')){\r\n        mapobj.addSource('vector', vector);\r\n        mapobj.addLayer({\r\n            \"id\": \"vector\",\r\n            \"type\": \"line\",\r\n            \"source\": \"vector\",\r\n            \"source-layer\": \"road\",\r\n            \"minzoom\": 9,\r\n            \"maxzoom\": 18,\r\n            \"paint\": {\r\n                    'line-opacity': 1.0,\r\n                    'line-color': 'rgb(80, 80, 80)',\r\n                    'line-width': 2\r\n                }\r\n        });\r\n        mapobj.addLayer({\r\n            \"id\": \"label\",\r\n            \"type\": \"symbol\",\r\n            \"source\": \"vector\",\r\n            \"source-layer\": \"label\",\r\n            \"minzoom\": 9,\r\n            \"maxzoom\": 18,\r\n            \"layout\": {\r\n                'text-size': 16,\r\n                \"text-rotate\":[\"case\",[\"==\",[\"get\",\"arrng\"],2],[\"*\",[\"+\",[\"to-number\",[\"get\",\"arrngAgl\"]],90],-1],[\"*\",[\"to-number\",[\"get\",\"arrngAgl\"]],-1]],\r\n                \"text-field\":[\"get\",\"knj\"],\r\n                \"text-font\":[\"NotoSansCJKjp-Regular\"],\r\n                \"text-allow-overlap\": true,\r\n                \"text-keep-upright\":true,\r\n                \"text-allow-overlap\":false,\r\n                \"symbol-z-order\":\"auto\",\r\n                \"text-max-width\":60,\r\n                'text-variable-anchor': ['top', 'bottom', 'left', 'right'],\r\n                'text-justify': 'auto',\r\n                \"symbol-placement\": \"point\"\r\n            },\r\n            \"paint\": {\r\n                \"text-color\": \"black\",\r\n                \"text-opacity\": 1.0,\r\n                \"text-halo-color\": \"rgba(255,255,255,0.95)\",\r\n                \"text-halo-width\": 1.5,\r\n                \"text-halo-blur\": 1\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nconst setSky=(mapobj)=>{\r\n    if (!mapobj.getLayer('sky')){\r\n        mapobj.addLayer({\r\n            'id': 'sky',\r\n            'type': 'sky',\r\n            'paint': {\r\n            'sky-type': 'atmosphere',\r\n            'sky-atmosphere-sun': [0.0, 0.0],\r\n            'sky-atmosphere-sun-intensity': 15\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nconst getArg=(search)=>{\r\n    var arg = new Object;\r\n    var pair=search.substring(1).split('&');\r\n    for(var i=0;pair[i];i++) {\r\n        var kv = pair[i].split('=');\r\n        arg[kv[0]]=kv[1];\r\n    }\r\n    return arg;\r\n}\r\n\r\nconst addPhoto=(map,xmin,xmax,ymin,ymax)=>{\r\n    const url=photo_URL+xmin+\"/\"+ymin+\"/\"+(xmax-xmin)+\"/\"+(ymax-ymin);\r\n    axios.get(url)\r\n    .then(function (res) {\r\n        map.addSource('photo', {\r\n            'type': 'geojson',\r\n            'data': res.data\r\n        });\r\n        map.addLayer({\r\n            'id': 'photoId',\r\n            'source': 'photo',\r\n            'type': 'symbol',\r\n            'layout': {\r\n                'icon-image': 'custom-marker',\r\n                'text-size': 12,\r\n                \"text-field\":[\"get\",\"title\"],\r\n                \"text-font\":[\"NotoSansCJKjp-Regular\"],\r\n                \"text-allow-overlap\": true,\r\n                \"text-keep-upright\":true,\r\n                \"text-allow-overlap\":false,\r\n                \"symbol-z-order\":\"auto\",\r\n                \"text-max-width\":60,\r\n                'text-variable-anchor':  ['top', 'bottom', 'left', 'right'],\r\n                'text-justify': 'auto',\r\n                \"symbol-placement\": \"point\",\r\n                \"icon-offset\":[0,32]\r\n            },\r\n            \"paint\": {\r\n                \"text-color\": \"red\",\r\n                \"text-opacity\": 1.0,\r\n                \"text-halo-color\": \"rgba(255,255,255,0.95)\",\r\n                \"text-halo-width\": 1.5,\r\n                \"text-halo-blur\": 1\r\n            }\r\n        });\r\n\r\n        map.on('click', 'photoId', function(e) {\r\n            const ll=new mapbox.LngLat(e.features[0].geometry.coordinates[0], e.features[0].geometry.coordinates[1]);\r\n            const prop=e.features[0].properties;\r\n            const divElement = document.createElement('div');\r\n            const pElement = document.createElement('p');\r\n            pElement.innerHTML=prop[\"title\"]+\"(\"+prop[\"date\"]+\")\";\r\n            const imgElement = document.createElement('img');\r\n            imgElement.setAttribute(\"src\",\"data:image/png;base64,\"+prop[\"thumbnail\"]);\r\n            imgElement.setAttribute(\"style\",\"width:100%;z-index:100;\");\r\n            imgElement.addEventListener('click', (e) => {\r\n                imagePop(image_URL+prop[\"image\"]);\r\n            });\r\n            divElement.appendChild(pElement);\r\n            divElement.appendChild(imgElement);\r\n            imageClose();\r\n            new mapbox.Popup()\r\n            .setLngLat(ll)\r\n            .setDOMContent(divElement)\r\n            .addTo(map);\r\n        });\r\n    });\r\n};\r\n\r\nconst frame=(time)=>{\r\n    if (!start){\r\n        start = time;\r\n//        phase=0.0;\r\n    }else{\r\n        if (typeof time !== \"undefined\") {\r\n            let dd=time-start;\r\n            start=time;\r\n            phase=phase+speed*dd*speedMul*0.5;\r\n        }else{\r\n            start=Date.now();\r\n        }\r\n    }\r\n    setSlider(phase);\r\n    if (phase >= 1) {\r\n        setTimeout(function () {\r\n            running=false;\r\n            endRunning();\r\n        }, 1500);\r\n    }\r\n    let alongRoute = turf.along(\r\n        turf.lineString(targetRoute),\r\n        routeDistance * phase\r\n    ).geometry.coordinates;\r\n    let camera = map.getFreeCameraOptions();\r\n    camera.position = mapbox.MercatorCoordinate.fromLngLat({\r\n            lng: alongRoute[0]-camera_angle[0],\r\n            lat: alongRoute[1]-camera_angle[1]\r\n        },\r\n        cameraAltitude\r\n    ); \r\n    camera.lookAtPoint({\r\n        lng: alongRoute[0],\r\n        lat: alongRoute[1]\r\n    });\r\n    map.setFreeCameraOptions(camera);\r\n    let point = {\r\n        'type': 'FeatureCollection',\r\n        'features': [{\r\n            'type': 'Feature',\r\n            'properties': {},\r\n            'geometry': {\r\n                'type': 'Point',\r\n                'coordinates': alongRoute\r\n            }\r\n        }]\r\n    };\r\n    let src=map.getSource('point');\r\n    if(src)src.setData(point);\r\n    if(running){\r\n        runAni=requestAnimationFrame(frame);\r\n    }else{\r\n        cancelAnimationFrame(runAni);\r\n    }\r\n};\r\n","import React, {Component} from 'react';\r\nimport ImageList from '@material-ui/core/ImageList';\r\nimport ImageListItem from '@material-ui/core/ImageListItem';\r\nimport ImageListItemBar from '@material-ui/core/ImageListItemBar';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport {parseGeojson} from './MapPane'\r\nimport axios from 'axios';\r\nimport * as d3 from 'd3';\r\n\r\nconst itemData = [];\r\n\r\nconst fileRead=(data)=>{\r\n//  let url=\"/potaling/geojson/\"+getItem(data.target.alt);\r\n  const params = new URLSearchParams(window.location.search);\r\n  params.set('p', data.target.alt); \r\n  window.location.search = params.toString();\r\n/*\r\n  axios.get(url)\r\n  .then(res => {\r\n    const val = res.data;\r\n    let str=JSON.stringify(val);\r\n    parseGeojson(str)\r\n  });\r\n  */\r\n};\r\n\r\nconst getItem=(id)=>{\r\n  for(let i=0;i<itemData.length;i++){\r\n    if(id==itemData[i].no){\r\n      return itemData[i].json;\r\n    }\r\n  }\r\n  return \"\"\r\n}\r\n\r\nexport function startPage(page){\r\n  for(let i=0;i<itemData.length;i++){\r\n    if(itemData[i].no==page){\r\n      let url=\"/potaling/geojson/\"+getItem(page);\r\n      axios.get(url)\r\n      .then(res => {\r\n        const val = res.data;\r\n        let str=JSON.stringify(val);\r\n        parseGeojson(str)\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default class MainListItems extends Component{\r\n\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  componentDidMount() {\r\n    let url=\"/potaling/pota_data.csv\";\r\n    d3.csv(url, function(data) {\r\n      itemData.push(data);\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n      <ImageList cols={1}>\r\n        <ImageListItem key=\"Subheader\">\r\n          <ListSubheader component=\"div\">ポタリングデータ</ListSubheader>\r\n        </ImageListItem>\r\n        {itemData.map((item) => (\r\n          <ImageListItem key={item.img}>\r\n            <img\r\n              srcSet={`${process.env.PUBLIC_URL}/images/${item.img}`}\r\n              alt={item.no}\r\n              loading=\"lazy\"\r\n              onClick={fileRead}\r\n            />\r\n            <ImageListItemBar\r\n              title={item.title}\r\n              subtitle={item.date}\r\n              actionIcon={\r\n                <IconButton\r\n                  sx={{ color: 'rgba(255, 255, 255, 0.54)' }}\r\n                  aria-label={`info about ${item.title}`}\r\n                >\r\n                  <InfoIcon />\r\n                </IconButton>\r\n              }\r\n            />\r\n          </ImageListItem>\r\n        ))}\r\n      </ImageList>\r\n    </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\n\r\nfunction SimpleDialog(props) {\r\n  const { onClose, selectedValue, open } = props;\r\n\r\n  const handleClose = () => {\r\n    onClose(selectedValue);\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} aria-labelledby=\"simple-dialog-title\" open={open}>\r\n      <DialogTitle id=\"simple-dialog-title\">アプリの使い方</DialogTitle>\r\n      <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/qSJzxQrFlvE\" title=\"YouTube video player\" frameBorder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen></iframe>\r\n     </Dialog>\r\n  );\r\n}\r\n\r\nexport default function YoutubeDialog() {\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = (value) => {\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n      <div>\r\n      <Button variant=\"contained\" size=\"large\" onClick={handleClickOpen}>　使い方　</Button>\r\n      <SimpleDialog open={open} onClose={handleClose} />\r\n      </div>\r\n  );\r\n}","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DirectionsBikeIcon from '@material-ui/icons/DirectionsBike';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Link from '@material-ui/core/Link';\r\nimport Box from '@material-ui/core/Box';\r\nimport YotubeDialog from './SimpleDialog'\r\nimport {setup} from './Dashboard';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright © '}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        t.matsuoka\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n}));\r\n\r\nconst img_style = {\r\n  width: \"100%\" \r\n}; \r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport let handleDialogOpen;\r\nexport let handleDialogClose;\r\n\r\nexport default function FullScreenDialog(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(props.open);\r\n\r\n  handleDialogOpen = () => {\r\n    isLoadwidgets=false;\r\n    setOpen(true);\r\n  };\r\n\r\n  handleDialogClose = () => {\r\n    setOpen(false);\r\n    setup();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={open} onClose={handleDialogClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={handleDialogClose} aria-label=\"close\">\r\n              <DirectionsBikeIcon />\r\n            </IconButton>\r\n            <Typography variant=\"h6\" className={classes.title} onClick={handleDialogClose}>\r\n              ポタリングの記録\r\n            </Typography>\r\n            <Box sx={{ display: { xs: 'none', md: 'inline' } }}>\r\n              <div style={{marginRight:\"10px\",display:'inline'}} ><Follow /></div>\r\n              <div style={{marginRight:\"30px\",display:'inline'}}><a href=\"https://twitter.com/share\" className=\"twitter-share-button\" style={{marginRight:\"20px\"}}>Tweet</a></div>\r\n            </Box>\r\n            <CloseIcon onClick={handleDialogClose} />\r\n            <Button color=\"inherit\" onClick={handleDialogClose}>\r\n              Close\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <div>\r\n          <img src={`${process.env.PUBLIC_URL}/images/back.jpg`} style={img_style} alt={'top'} />\r\n          <Box textAlign=\"center\">\r\n          <h1>ポタリングした地域を3D地図で俯瞰する実験サイトです。</h1>\r\n          <p style={{fontSize: \"20px\"}}>ポタリング（自転車散歩）した地域を俯瞰してみたいと思い作成したWebアプリです。<br />\r\n            データ（geojson/gpx）を読み込むと、3D地図上で経路の俯瞰画像が表示されます。<br />\r\n            実際に走った経路を俯瞰してみると小さな発見があって結構面白いです。</p>\r\n          <Button variant=\"contained\" style={{margin:\"10px\"}} size=\"large\" onClick={handleDialogClose}>　開　始　</Button>\r\n          <YotubeDialog />\r\n          </Box>\r\n        </div>\r\n        <br />\r\n        <Copyright />\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nlet isLoadwidgets = false;\r\nconst Follow = () => {\r\n  React.useEffect(() => {\r\n    if (!isLoadwidgets) {\r\n      const s = document.createElement(\"script\");\r\n      s.setAttribute(\"src\", \"https://platform.twitter.com/widgets.js\");\r\n      document.body.appendChild(s);\r\n      isLoadwidgets = true;\r\n    }\r\n  }, []);\r\n  return (\r\n    <a href=\"https://twitter.com/t_mat?ref_src=twsrc%5Etfw\" className=\"twitter-follow-button\" data-show-count=\"false\">Follow @t_mat</a>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DirectionsBikeIcon from '@material-ui/icons/DirectionsBike';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Box from '@material-ui/core/Box';\r\nimport DatePicker from \"react-datepicker\";\r\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport axios from 'axios';\r\n\r\nlet fname;\r\nlet gpxParser = require('gpxparser');\r\n\r\nconst ALLOWED_METHODS = [\r\n    'GET',\r\n    'POST',\r\n    'PUT',\r\n    'PATCH',\r\n    'DELETE',\r\n    'HEAD',\r\n    'OPTIONS'\r\n];\r\n\r\nconst ALLOWED_ORIGINS = [\r\n    'https://127.0.0.1:3000',\r\n    'https://127.0.0.1:3001'\r\n];\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    dialog: {\r\n        padding: \"0px\",\r\n      },\r\n    toolbar: {\r\n        height:\"60px\",\r\n        color: \"#fff\",\r\n        backgroundColor: \"#3f51b5\",\r\n      },\r\n    title: {\r\n      marginLeft: theme.spacing(1),\r\n      flex: 1,\r\n    },\r\n    box: {\r\n        margin:\" 0 auto\"\r\n      },\r\n    textField:{\r\n        width:\"100%\",\r\n        fontSize:\"16px\",\r\n        fontfamily:\"sans-serif\",\r\n    },\r\n    image:{\r\n        width:\"360px\",\r\n    },\r\n    button: {\r\n        fontSize:\"16px\",\r\n        fontfamily:\"sans-serif\",\r\n        margin: theme.spacing(1),\r\n        width:\"100%\",\r\n      },\r\n  }));\r\n\r\n  const Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n  });\r\n  \r\n \r\n  export let registDialogOpen;\r\n  \r\n  export default function RegistDialog() {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = React.useState(false);\r\n    const [startDate, setStartDate] = useState(new Date());\r\n    const [photo_src, setPhotoSrc] = useState(null);\r\n    const [route_src, setRouteSrc] = useState(null);\r\n    const [json, setJson] = useState(null);\r\n  \r\n    registDialogOpen = () => {\r\n      setOpen(true);\r\n    };\r\n  \r\n    const handleClose = () => {\r\n      setOpen(false);\r\n    };\r\n  \r\n    const fileRead=()=>{\r\n        let fileInput = document.getElementById('file');\r\n        let fileReader = new FileReader();\r\n        fileInput.onchange = () => {\r\n            let file = fileInput.files[0];\r\n            if(!file||!file.name)return;\r\n            fname=file.name.toLowerCase();\r\n            fileReader.readAsText(file);\r\n        };\r\n        fileReader.onload = () => fileProc(fileReader.result);\r\n        fileInput.click();\r\n      };\r\n    \r\n      const fileProc=(obj)=>{\r\n        if(fname.endsWith(\".geojson\")){\r\n            setJson(obj);\r\n        }else if(fname.endsWith(\".json\")){\r\n            setJson(obj);\r\n        }else if(fname.endsWith(\".gpx\")){\r\n          let gpx=new gpxParser();\r\n          gpx.parse(obj);\r\n          obj=JSON.stringify(gpx.toGeoJSON());\r\n          setJson(obj);\r\n        }\r\n\r\n        axios.post(`http://localhost:4567/potaling/route`,obj,\r\n           {\r\n               headers: {'Content-Type': 'application/json'},\r\n               accept: \"application/json\",\r\n               withCredentials: false,\r\n               AccessControlAllowOrigin:\"*\",\r\n               AccessControlAllowMethods:\"GET,PUT,POST,DELETE,OPTIONS\",\r\n               preflightContinue: false,\r\n            })\r\n        .then(res => {\r\n          console.log(res);\r\n        })\r\n        .catch(function(error) {\r\n            console.log('ERROR!! occurred in Backend.')\r\n        });\r\n/*\r\n        const fetchOption = {\r\n            method: 'POST',\r\n            body: obj\r\n        };\r\n        const headers = new Headers();\r\n        headers.append('Access-Control-Allow-Origin', origin);\r\n        headers.append('Access-Control-Allow-Methods', ALLOWED_METHODS.join(','));\r\n        headers.append('Access-Control-Allow-Headers', 'Content-type,Accept,X-Custom-Header');\r\n        headers.append('Content-Type', 'application/json');\r\n        fetchOption['headers'] = headers;   \r\n\r\n        fetch(`http://localhost:4567/potaling/route`, fetchOption)\r\n        .then(res => {\r\n            console.log(res.status);\r\n        })\r\n        .catch(error => {\r\n            console.log(error);\r\n        });\r\n*/\r\n\r\n    };\r\n\r\n    const photoRead=()=>{\r\n        let fileInput = document.getElementById('file');\r\n        let fileReader = new FileReader();\r\n        fileInput.onchange = () => {\r\n            let file = fileInput.files[0];\r\n            if(!file||!file.name)return;\r\n            fname=file.name.toLowerCase();\r\n            fileReader.readAsDataURL(file);\r\n        };\r\n        fileReader.onload = () => setPhotoSrc(fileReader.result);\r\n        fileInput.click();\r\n      };\r\n\r\n    return (\r\n      <div>\r\n        <Dialog className={classes.dialog} open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n          <Toolbar className={classes.toolbar}>\r\n              <IconButton edge=\"start\" color=\"inherit\" onClick={handleClose} aria-label=\"close\">\r\n                <DirectionsBikeIcon />\r\n              </IconButton>\r\n              <Typography variant=\"h6\" className={classes.title} onClick={handleClose}>\r\n                データ登録\r\n              </Typography>\r\n              <CloseIcon onClick={handleClose} />\r\n          </Toolbar>\r\n            <Box className={classes.box}>\r\n                <table align=\"center\" width=\"100%\">\r\n                    <tbody className={classes.textField}>\r\n                    <tr>\r\n                        <td>タイトル</td>\r\n                        <td><TextField className={classes.textField} id=\"title\" label=\"title\" placeholder=\"タイトル名\" variant=\"standard\"　autoComplete=\"off\" /></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>データ　</td>\r\n                        <td><Button variant=\"contained\" onClick={fileRead} className={classes.button} startIcon={<FolderOpenIcon />}>読み込み</Button></td>\r\n                   </tr>\r\n                    <tr>\r\n                        <td>記録日　</td>\r\n                        <td><DatePicker className={classes.textField} selected={startDate} onChange={(date) => setStartDate(date)} /></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>写　真　</td>\r\n                        <td><Button variant=\"contained\" onClick={photoRead} className={classes.button} startIcon={<FolderOpenIcon />}>読み込み</Button></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colSpan=\"2\"><img className={classes.image} src={route_src} /></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colSpan=\"2\"><img className={classes.image} src={photo_src} /></td>\r\n                    </tr>\r\n                    </tbody>\r\n                </table>\r\n            </Box>\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  };\r\n\r\n","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles,useTheme } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Drawer from '@material-ui/core/Drawer';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport List from '@material-ui/core/List';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport Container from '@material-ui/core/Container';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport MainListItems from './listItems';\nimport jumpData from './listItems';\nimport MapPane from './MapPane';\nimport ControlBar from './ControlBar';\nimport NotificationsIcon from '@material-ui/icons/Notifications';\nimport MapIcon from '@material-ui/icons/Map';\nimport AllOutIcon from '@material-ui/icons/AllOut';\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\nimport {fitBounds,parseGeojson,changeStyle} from './MapPane'\nimport FullScreenDialog from './FullScreenDialog'\nimport {handleDialogOpen} from './FullScreenDialog'\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Grid from '@material-ui/core/Grid';\nimport RegistDialog from './RegistDialog'\nimport Imagepopup from './Imagepopup'\nimport {registDialogOpen} from './RegistDialog';\n\nlet gpxParser = require('gpxparser');\nlet tcxParse = require('tcx');\nvar DOMParser = require('xmldom').DOMParser;\nconst drawerWidth = 300;\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n  },\n  appBar: {\n    height:'65px',\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n  appBarShift: {\n    width: `calc(100% - ${drawerWidth}px)`,\n    marginLeft: drawerWidth,\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  hide: {\n    display: 'none',\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    boxSizing: 'border-box',\n  },\n  drawerHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n    justifyContent: 'flex-end',\n  },\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(3),\n    transition: theme.transitions.create('margin', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    marginLeft: -drawerWidth,\n  },\n  contentShift: {\n    transition: theme.transitions.create('margin', {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n    marginLeft: 0,\n  },\n  toolbarButtons: {\n    marginLeft: 'auto',\n  },\n}));\n\nlet fname;\n\nconst fileRead=()=>{\n  let fileInput = document.getElementById('file');\n  let fileReader = new FileReader();\n  fileInput.onchange = () => {\n      let file = fileInput.files[0];\n      if(!file||!file.name)return;\n      fname=file.name.toLowerCase();\n      console.log(file.name);\n      console.log(file.size);\n      console.log(file.type);\n      fileReader.readAsText(file);\n  };\n  fileReader.onload = () => fileProc(fileReader.result);\n  fileInput.click();\n};\n\nconst fileProc=(obj)=>{\n  if(fname.endsWith(\".geojson\")){\n      parseGeojson(obj);\n  }else if(fname.endsWith(\".json\")){\n    parseGeojson(obj);\n  }else if(fname.endsWith(\".gpx\")){\n    let gpx=new gpxParser();\n    gpx.parse(obj);\n    parseGeojson(JSON.stringify(gpx.toGeoJSON()));\n  }else if(fname.endsWith(\".tcx\")){\n    var doc = new DOMParser().parseFromString(obj);\n    let tcx=tcxParse(doc);\n    parseGeojson(JSON.stringify(tcx));\n  }\n};\n\nlet current_map=0;\n//let MAPS=[MapPane.PHT,MapPane.STD,MapPane.SAT];\nlet MAPS=[MapPane.PHT,MapPane.STD];\n\nconst changeMap=()=>{\n  current_map=(current_map+1)%MAPS.length;\n  changeStyle(MAPS[current_map],current_map);\n}\n\nexport let setup;\n\nexport default function Dashboard(props) {\n  const classes = useStyles();\n  const theme = useTheme();\n  const [open, setOpen] = React.useState(false);\n\n  const handleDrawerOpen = () => {\n    setOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setOpen(false);\n  };\n\n  setup=()=>{\n    if(props.window){\n      handleDrawerOpen();\n      setTimeout(handleDrawerClose,1000);\n    }\n  };\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open,\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, open && classes.hide)}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" noWrap component=\"div\" sx={{ display: { xs: 'none', md: 'block' } }}>\n            ポタリングの記録\n          </Typography>\n          <div className={classes.toolbarButtons}>\n          <Grid container alignItems=\"center\" className={classes.root}>\n          <Divider orientation=\"vertical\" flexItem />\n          <Tooltip title=\"ログ読込\" placement=\"bottom\">\n            <IconButton color=\"inherit\" onClick={fileRead}>\n              <FolderOpenIcon />\n            </IconButton>\n            </Tooltip>\n            <input type=\"file\" accept=\".geojson,.gpx,.tcx\" id=\"file\" style={{ display: 'none'}}></input>\n            <Tooltip title=\"地図切替\" placement=\"bottom\">\n            <IconButton color=\"inherit\" onClick={changeMap}>\n              <MapIcon />\n            </IconButton>\n            </Tooltip>\n            <Tooltip title=\"領域移動\" placement=\"bottom\">\n            <IconButton color=\"inherit\" onClick={fitBounds}>\n              <AllOutIcon />\n            </IconButton>\n            </Tooltip>\n            <Tooltip title=\"トップページ\" placement=\"bottom\">\n            <IconButton color=\"inherit\" onClick={handleDialogOpen}>\n              <NotificationsIcon />\n            </IconButton>\n            </Tooltip>\n{/*\n            <Tooltip title=\"登録\" placement=\"bottom\">  \n            <IconButton color=\"inherit\" onClick={registDialogOpen}>\n              <NotificationsIcon />\n            </IconButton>\n            </Tooltip>\n*/}\n            <Divider orientation=\"vertical\" flexItem />\n            </Grid>\n          </div>\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        className={classes.drawer}\n        variant=\"persistent\"\n        anchor=\"left\"\n        open={open}\n        classes={{\n          paper: classes.drawerPaper,\n        }}\n      >\n        <div className={classes.drawerHeader}>\n          <IconButton onClick={handleDrawerClose}>\n            {theme.direction === 'ltr' ? <ChevronLeftIcon /> : <ChevronRightIcon />}\n          </IconButton>\n        </div>\n        <Divider />\n        <List><MainListItems /></List>\n        <Divider />\n      </Drawer>\n      <main\n        className={clsx(classes.content, {\n          [classes.contentShift]: open,\n        })}\n      >\n        <div className={classes.drawerHeader} />\n        <Container maxWidth=\"xl\" className={classes.container} onClick={handleDrawerClose} >\n          <MapPane />\n          <ControlBar /> \n        </Container>\n      </main>\n      <FullScreenDialog open={props.window}/>\n      <Imagepopup />\n      <RegistDialog />\n    </div>\n  );\n}\n","import React from 'react';\r\nimport { BrowserRouter, Routes ,Route,useParams,useLocation} from 'react-router-dom';\r\nimport Dashboard from './components/Dashboard';\r\n\r\nconst App=()=> {\r\n  return (\r\n    <BrowserRouter>\r\n      <Routes>\r\n        <Route path='/potaling' element={<Child />} />\r\n        <Route path=\"*\" element={<div>404 page not found.</div>} />\r\n      </Routes>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nexport const Child = () => {\r\n  const location = useLocation();\r\n  const arg=getArg(location.search);\r\n  if(arg[\"p\"]){\r\n    return (\r\n      <Dashboard window={false} />\r\n    )\r\n  }else{\r\n    return (\r\n      <Dashboard window={true} />\r\n    )\r\n  }\r\n}\r\n\r\nconst getArg=(search)=>{\r\n  var arg = new Object;\r\n  var pair=search.substring(1).split('&');\r\n  for(var i=0;pair[i];i++) {\r\n      var kv = pair[i].split('=');\r\n      arg[kv[0]]=kv[1];\r\n  }\r\n  return arg;\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}